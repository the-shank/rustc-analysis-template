util functions are borrowed from [nopcrat](https://github.com/kaist-plrg/nopcrat)
